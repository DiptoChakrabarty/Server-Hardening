tasks:
  - name: download apt keys
    apt_key:
      url: https://download.docker.com/linux/ubuntu/gpg
      state: present
  
  - name: add repository
    apt_repository:
      repo: 'deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable'
      state: present
      filename: docker
      update_cache: yes
  - name: install packages needed
    package:
      name: "{{ item }}"
      state: present
    with_items:
      - apt-transport-https 
      - ca-certificates 
      - curl 
      - gnupg-agent 
      - software-properties-common
  - name: install docker
    apt:
      name: docker-ce
      state: present
  - name: start and enable docker services
    service:
      name: "docker"
      state: started
      enabled: yes
      
